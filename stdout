
****************************BEGINNING OF DRIVER EXECUTION*****************************
Analysis of NYC green taxi data in September, 2015 

Data science challenge - Qi Li
**********************************************************************************

Downloading data from https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-09.csv ...

Reporting the size of the original data:
Total number of rows:  1494926
Total number of cols:  21 

=====================================================================================
Data Cleaning Routine Launched -------->   
-------------------------------------------------------------------------------------

Checking the number of missing values in each column:
VendorID                       0
lpep_pickup_datetime           0
Lpep_dropoff_datetime          0
Store_and_fwd_flag             0
RateCodeID                     0
Pickup_longitude               0
Pickup_latitude                0
Dropoff_longitude              0
Dropoff_latitude               0
Passenger_count                0
Trip_distance                  0
Fare_amount                    0
Extra                          0
MTA_tax                        0
Tip_amount                     0
Tolls_amount                   0
Ehail_fee                1494926
improvement_surcharge          0
Total_amount                   0
Payment_type                   0
Trip_type                      4
dtype: int64

Dropping the 'Ehail_fee' column ... 

Percentage of 'Trip_type' = 1.0:
97.76443783839468 %
Filling the missing values for 'Trip_type' with 1.0 ... 

Converting the datetime object columns to datetime type ...

Taking the absolute value of the 'price' related columns ... 

Percentage of rows with total fare < 2.50:
0.31834351666905253 %
Dropping the rows with total fare < 2.50 ... 

Calculating the difference between the total fare and the sum of the pieces for each row and store in a new column ...
Percentage of rows with mismatching total fare:
0.00530141923690432 %
Dropping the rows with wrong total fare ... 

Checking the 'Extra' column:
0.00     679738
0.50     567272
1.00     243076
12.00         1
0.25          1
Name: Extra, dtype: int64
Dropping the rows with wrong 'Extra' column ... 

Checking the 'Passenger_count' column:
1    1251960
2     114517
5      57847
3      33658
6      22085
4       9703
0        262
8         29
7         14
9         11
Name: Passenger_count, dtype: int64
Replacing the rows with 0 'Passenger_count' with the most frequent value (1) ... 

-------------------------------------------------------------------------------------
Data Cleaning Routine Finished :-) 
Old dataframe size: 1494926 rows 21 columns
New dataframe size: 1490086 rows 20 columns
=====================================================================================

=====================================================================================
Feature Engineering Routine Launched -------->   
-------------------------------------------------------------------------------------

Adding two new columns 'Day_of_week' and 'Day_of_month' ...
Calculating the time span for each trip and store it in a new column 'Time_span' ...

Adding a new column 'Speed' ...
Dropping rows with outliners in 'Trip_distance'/'Speed'/'Time_span'...
Average speed mean is 13.012392708438513 mph
Average speed median is 11.858823529411765 mph

Adding a new column 'Fare_per_mile' ...
Dropping rows with outliners in 'Fare_per_mile'...
Fare/mile mean is 6.385627539402415 $/mile
Fare/mile median is 5.833333333333333 $/mile
-------------------------------------------------------------------------------------
Feature Engineering Routine Finished :-) 
Old dataframe size: 1490086 rows 20 columns
New dataframe size: 1431501 rows 27 columns
=====================================================================================

=====================================================================================
Trip distance Analysis Routine Launched -------->   
-------------------------------------------------------------------------------------

Reporting stats for the raw data:
Lanching statistical parameter report routine ---> 
The mean of the Trip_distance  =  2.96891749201053
The stddev of the Trip_distance  =  3.073826462834637
The median of the Trip_distance  =  1.98
The skew of the Trip_distance  =  8.454927962459058
The kurtosis of the Trip_distance  =  1028.7546870955628

Reporting stats for the cleaned data:
Lanching statistical parameter report routine ---> 
The mean of the Trip_distance  =  2.968185464068836
The stddev of the Trip_distance  =  2.766582560000035
The median of the Trip_distance  =  2.01
The skew of the Trip_distance  =  2.2059920697803483
The kurtosis of the Trip_distance  =  6.141637084643266
Grouping the trip distance by hour of day using pandas.pivot_table:

Begin analysis of JFK trips:
There are 4417 trips from/to JFK airport in the raw data.
There are 1897 trips from/to JFK airport in the cleaned data.

Printing the total fare statistical indexes of the JFK trips from the raw data:
Lanching statistical parameter report routine ---> 
The mean of the Total_amount  =  59.41863492063493
The stddev of the Total_amount  =  7.536265851810568
The median of the Total_amount  =  58.34
The skew of the Total_amount  =  0.7686467529120234
The kurtosis of the Total_amount  =  -0.5288622046709097

Printing the total fare statistical indexes of the JFK trips from the clean data:
Lanching statistical parameter report routine ---> 
The mean of the Total_amount  =  64.14821296784396
The stddev of the Total_amount  =  6.488690889391416
The median of the Total_amount  =  63.36
The skew of the Total_amount  =  0.027823596487138273
The kurtosis of the Total_amount  =  -0.8299447493017844
-------------------------------------------------------------------------------------
Trip distance Analysis Routine Finished :-) 
=====================================================================================

=====================================================================================
Trip Speed Analysis Routine Launched -------->   
-------------------------------------------------------------------------------------

Reporting stats for the trip average speed:
Lanching statistical parameter report routine ---> 
The mean of the Speed  =  13.027303406187954
The stddev of the Speed  =  5.372552866936621
The median of the Speed  =  11.87027027027027
The skew of the Speed  =  1.4830277551021442
The kurtosis of the Speed  =  2.9565856723916637

Performing ANOVA on the speed in different weeks ...
F_onewayResult(statistic=5.938834463883594, pvalue=9.157111256965753e-05)
-------------------------------------------------------------------------------------
Trip Speed Analysis Routine Finished :-) 
=====================================================================================

=====================================================================================
Predictive Model Routine Launched -------->   
-------------------------------------------------------------------------------------

Generating the 'Tip_rate' variable:

Performing Decision Tree regressor:
Fitting and CV finished in 0 seconds!
Printing the results of the cross_validation:
accuracy mean:  0.9872457909268988
accuracy stddev:  0.005546307167547986

Performing Random Forest regressor:
Fitting and CV finished in 11 seconds!
Printing the results of the cross_validation:
accuracy mean:  0.9920412673083332
accuracy stddev:  0.007038627485890182

Performing GMB regressor:
Fitting and CV finished in 27 seconds!
Printing the results of the cross_validation:
accuracy mean:  0.9935626202351904
accuracy stddev:  0.005480225688361271
-------------------------------------------------------------------------------------
Predictive Model Routine Finished :-) 
=====================================================================================

Total execution time:  95 seconds!

****************************END OF DRIVER EXECUTION*****************************
